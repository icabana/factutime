<?php           $this->pdf = new PdfReportes();		    $this->pdf->SetCreator('ISMAEL CABANA');    $this->pdf->SetAuthor('ISMAEL CABANA');    $this->pdf->SetTitle('REPORTE DEL PRESUPUESTO DEL PROYECTO');    $this->pdf->SetSubject('PRESUPUESTO DEL PROYECTO.');    $this->pdf->AliasNbPages();    $this->pdf->SetTextColor(0,0,0);    $this->pdf->SetFillColor( 239, 239, 239 );  		    $anchos = array('5', '10', '25','35','45', '55', '65', '115', '30');    $this->pdf->SetMargins("20","9","20");    $this->pdf->AddPage();    $this->pdf->SetFont('Arial','B',6);                        $contador = 1;            $this->pdf->SetFont('Arial','',10);    $this->pdf->ln();$this->pdf->ln();    $params = Parametros::singleton();        $this->pdf->SetFont('Arial','B',10);     $this->pdf->Cell(0, 5, utf8_decode("Corporación Educativa Asesorias del Norte"),0,1,'C');                $this->pdf->SetFont('Arial','',7);                           $this->pdf->Cell(0, 3, $params->valor('NITEMPRESA'),0,1,'C');                 $this->pdf->Cell(0, 3, $params->valor('DIREMPRESA'),0,1,'C');             $this->pdf->Cell(0, 3, $params->valor('TELEFEMPRESA'),0,1,'C');             $this->pdf->Cell(0, 3, $params->valor('CORREOEMPRESA'),0,1,'C');               $this->pdf->SetXY(165, 15);        $this->pdf->SetFont('Arial','',6);                                  $this->pdf->Cell(27, 3, utf8_decode('Crédito Educativo'),0,1);             $consecutivo = "";             for($i = strlen($factura['CONSECUTIVO_FACTURA']); $i<10 ; $i++){                $consecutivo .= "0";                                    }                             $consecutivo.= "".$factura['CONSECUTIVO_FACTURA'];                                             $this->pdf->SetXY(165, 18);        $this->pdf->SetFont('Arial','B',6);             $this->pdf->Cell(27, 3, utf8_decode('No. ').$consecutivo,0,0);                       $this->pdf->SetXY(165, 21);     $this->pdf->SetFont('Arial','',6);          $this->pdf->Cell(27, 3, utf8_decode('Régimen Común'),0,0);                 $this->pdf->SetXY(30, 27);           $this->pdf->ln();       $this->pdf->SetFont('Arial','B',6);          $this->pdf->Cell(18, 3, utf8_decode('SEÑOR(A): '),1,0,'',1);       $this->pdf->SetFont('Arial','',6);          $this->pdf->Cell(70, 3, $factura['NOMBRES_ESTUDIANTE']." ".$factura['APELLIDOS_ESTUDIANTE'],1,0);               $this->pdf->SetFont('Arial','B',6);                $this->pdf->Cell(18, 3, utf8_decode('DOCUMENTO: '),1,0,'',1);         $this->pdf->SetFont('Arial','',6);          $this->pdf->Cell(22, 3,  $factura['DOCUMENTO_ESTUDIANTE'],1,0);              $this->pdf->SetFont('Arial','B',6);           $this->pdf->Cell(0, 3, utf8_decode('FECHA DE EXPEDICIÓN AAAA-MM-DD'),1,1,'C',1);                          $this->pdf->SetFont('Arial','B',6);                $this->pdf->Cell(18, 3, utf8_decode('DIRECCIÓN: '),1,0,'',1);         $this->pdf->SetFont('Arial','',6);          $this->pdf->Cell(110, 3, $factura['DIRECCION_ESTUDIANTE'],1,0);                       $this->pdf->Cell(0, 3, $factura['FECHA_FACTURA'],1,1,'C');                       $this->pdf->SetFont('Arial','B',6);              $this->pdf->Cell(18, 3, utf8_decode('CIUDAD: '),1,0,'',1);      $this->pdf->SetFont('Arial','',6);        $this->pdf->Cell(110, 3, $factura['CIUDAD_ESTUDIANTE'],1,0);      $this->pdf->SetFont('Arial','B',6);      $this->pdf->Cell(0, 3, utf8_decode('FECHA DE VENCIMIENTO AAAA-MM-DD'),1,1,'C',1);                    $this->pdf->SetFont('Arial','B',6);              $this->pdf->Cell(18, 3, utf8_decode('TELÉFONO: '),1,0,'',1);      $this->pdf->SetFont('Arial','',6);        $this->pdf->Cell(50, 3,  $factura['TELEFONO_ESTUDIANTE']." - ".$factura['CELULAR_ESTUDIANTE'],1,0);          $this->pdf->SetFont('Arial','B',6);              $this->pdf->Cell(20, 3, utf8_decode('CORREO: '),1,0,'',1);      $this->pdf->SetFont('Arial','',6);        $this->pdf->Cell(40, 3,  $factura['CORREO_ESTUDIANTE'],1,0);                                          $this->pdf->Cell(0, 3,$factura['FECHA_FACTURA'],1,1,'C');      $this->pdf->SetFont('Arial','B',6);                     $this->pdf->Cell(18, 3, utf8_decode('PROGRAMA: '),1,0,'',1);       $this->pdf->SetFont('Arial','',6);          $this->pdf->Cell(100, 3, $admision['NOMBRE_PROGRAMA'],1,0);               $this->pdf->SetFont('Arial','B',6);                $this->pdf->Cell(30, 3, utf8_decode('CÓDIGO ADMISIÓN: '),1,0,'',1);         $this->pdf->SetFont('Arial','',6);          $this->pdf->Cell(22, 3,  $admision['CODIGO_ADMISION'],1,0);                $this->pdf->ln();  $this->pdf->ln();               $this->pdf->SetWidths(array(70,16,16,16,16,16,20));            $this->pdf->SetAligns(array('L','C','C','C','C','C','C'));        $this->pdf->SetFont('Arial','B',6);    $this->pdf->Cell(70, 5, utf8_decode('Items'),1,0, "C", 1);      $this->pdf->Cell(16, 5, utf8_decode('Precio'),1,0, "C", 1);     $this->pdf->Cell(16, 5, utf8_decode('Cantidad'),1,0, "C", 1);        $this->pdf->Cell(16, 5, utf8_decode('Subtotal'),1,0, "C", 1);        $this->pdf->Cell(16, 5, utf8_decode('Descuento'),1,0, "C", 1);        $this->pdf->Cell(16, 5, utf8_decode('Impuesto'),1,0, "C", 1);        $this->pdf->Cell(20, 5, utf8_decode('Total'),1,1, "C", 1);        $this->pdf->SetFont('Arial','',6);               foreach ($productos as $producto){                                $this->pdf->Row(            array(                $producto['CODIGO_PRODUCTO']." - ".$producto['NOMBRE_PRODUCTO'],                "$".number_format($producto['PRECIOUNITARIO_FACPRO'],0,',','.'),                $producto['CANTIDAD_FACPRO'],                "$".number_format($producto['SUBTOTAL_FACPRO'],0,',','.'),                $producto['DESCUENTO_FACPRO']."%",                $producto['IMPUESTO_FACPRO']."%",                "$".number_format($producto['TOTAL_FACPRO'],0,',','.')            )        );             }                    $y =   $this->pdf->GetY();          if($factura['TERMINO_FACTURA'] > 1){       $this->pdf->ln();        $this->pdf->Cell(20, 4, utf8_decode('Listado de Cuotas: '),0,0);  $this->pdf->ln();        $fechas = new Fechas();            $valor_cuota = 0;        $sumas_cuotas = 0;                    $valor_cuota = ($factura['TOTAL_FACTURA'] - $total_creditos)/$factura['TERMINO_FACTURA'];            $conta = 1;                 $j = 0;        for ($i=1; $i<=$factura['TERMINO_FACTURA']; $i++) {             if($datos_factura['TIPOPAGO_FACTURA'] == "MENSUAL"){                    $proxima_fecha = $fechas->sumarmeses2($datos_factura['FECHA2_FACTURA'], $i);            }else{                $j += 14;                                $proxima_fecha = $fechas->sumardias2($datos_factura['FECHA2_FACTURA'], $j);            }            $sumas_cuotas += $valor_cuota;                        if($estado_factura == "PAGADA"){                             $this->pdf->Cell(50, 4, utf8_decode("CUOTA ".$i.": $".number_format($valor_cuota,0,',','.')." (PAGADA)"),0,0);                                            }else{                                $lo_que_se_a_pagado = ($factura['TOTAL_FACTURA'] - $total_creditos) - $saldo_factura;                                 if($sumas_cuotas <= $lo_que_se_a_pagado){                                      $this->pdf->Cell(70, 4, utf8_decode("CUOTA ".$i.": $".number_format($valor_cuota,0,',','.')." (PAGADA)"),0,0);                                                             }else{                                                                  $a_pagar = $sumas_cuotas - $lo_que_se_a_pagado;                                                  if($a_pagar > $valor_cuota){                             $a_pagar = $valor_cuota;                         }                                                                  $this->pdf->Cell(70, 4, utf8_decode("CUOTA ".$i.": $".number_format($a_pagar,0,',','.')." (Fecha de Pago: ".$proxima_fecha.")"),0,0);                                                             }                            }                                    if($conta % 2 == 0){                $this->pdf->ln();            }                        $conta++;                    }                   if($estado_factura != "PAGADA"){        $this->pdf->ln(); $this->pdf->ln();         $this->pdf->SetFont('Arial','B',7);        $this->pdf->Cell(21, 4, utf8_decode("TOTAL PAGADO: "),0,0);          $this->pdf->SetFont('Arial','',7);        $this->pdf->Cell(15, 4, utf8_decode("$".number_format($lo_que_se_a_pagado,0,',','.')),0,0);          $this->pdf->SetFont('Arial','B',7);        $this->pdf->Cell(27, 4, utf8_decode("SALDO PENDIENTE: "),0,0);          $this->pdf->SetFont('Arial','',7);        $this->pdf->Cell(20, 4, utf8_decode("$".number_format($sumas_cuotas-$lo_que_se_a_pagado,0,',','.')),0,0);         }        }      $this->pdf->SetXY(150,$y);           $this->pdf->SetFont('Arial','B',6);       $this->pdf->Cell(20, 4, utf8_decode('Subtotal: '),1,0, 'R', 1);          $this->pdf->SetFont('Arial','',6);        $this->pdf->Cell(20, 4, "$".number_format($factura['SUBTOTAL_FACTURA'] - $factura['DESCUENTO_FACTURA'],0,',','.'),1,1, 'C');                                 $this->pdf->SetX(150);           $this->pdf->SetFont('Arial','B',6);       $this->pdf->Cell(20, 4, "(-) ".utf8_decode('Notas Crédito: '),1,0, 'R', 1);          $this->pdf->SetFont('Arial','',6);       $this->pdf->Cell(20, 4, "$".number_format($total_creditos,0,',','.'),1,1, 'C');                                  $this->pdf->SetX(150);           $this->pdf->SetFont('Arial','B',6);       $this->pdf->Cell(20, 4, "(+) ".utf8_decode('Impuesto 5%: '),1,0, 'R', 1);          $this->pdf->SetFont('Arial','',6);       $this->pdf->Cell(20, 4, "$".number_format($factura['IMPUESTO5_FACTURA'],0,',','.'),1,1, 'C');                             $this->pdf->SetX(150);           $this->pdf->SetFont('Arial','B',6);       $this->pdf->Cell(20, 4, "(+) ".utf8_decode('Impuesto 19%: '),1,0, 'R', 1);          $this->pdf->SetFont('Arial','',6);       $this->pdf->Cell(20, 4, "$".number_format($factura['IMPUESTO19_FACTURA'],0,',','.'),1,1, 'C');                                  $this->pdf->SetX(150);           $this->pdf->SetFont('Arial','B',7);       $this->pdf->Cell(20, 4, utf8_decode('Total: '),1,0, 'R', 1);          $this->pdf->SetFont('Arial','B',7);       $this->pdf->Cell(20, 4, "$".number_format($factura['TOTAL_FACTURA']  - $total_creditos,0,',','.'),1,1, 'C');                            $this->pdf->SetFont('Arial','',6);      $this->pdf->SetY("245");          $this->pdf->MultiCell(105, 3, utf8_decode('Autorizo que en caso de incumplimento de esta obligacion sea reportado a las centrales de riesgo, se cobrarán intereses por mora.'),0, 'J');                           $this->pdf->Line(15, 263, 75, 263);              $this->pdf->SetY("264");          $this->pdf->Cell(50, 3, utf8_decode('ELABORADA POR'),0,1, 'C');                           $this->pdf->Line(80, 263, 140, 263);              $this->pdf->SetXY("85", "264");          $this->pdf->Cell(50, 3, utf8_decode('ACEPTADA, FIRMA Y/O SELLO Y FECHA'),0,1, 'C');                               ?>